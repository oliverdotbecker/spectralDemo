%% Erläuterungen zu den Befehlen erfolgen unter
%% diesem Beispiel.

\documentclass[11pt]{scrartcl}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[ngerman]{babel}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{wrapfig}
\usepackage{float}
\usepackage[printonlyused, footnote]{acronym}
\usepackage[
    colorlinks=true,
    urlcolor=blue,
    linkcolor=black,
    citecolor=black
]{hyperref}
\usepackage[font={scriptsize},figurename=Bild]{caption}

\title{MASTER THESIS}
\author{Oliver Becker}
\date{31. Oktober 2019} %%\today
\begin{document}

\begin{center}
    \center\includegraphics[width=0.4\linewidth]{images/logo.png}
    \paragraph{}
    \huge MASTER THESIS
\end{center}
\vspace{1cm}\noindent
\begin{center}
    \huge \color{red} Vorabversion 0.95\\
    \large Stand: \today
\end{center}
\vspace{1cm}\noindent
{\large Title:  Abgleich von LED Lichtquellen auf Basis einer komplexen Lichtsteuerung}
\par\vspace{3cm}\noindent
Submitted by:               Oliver Becker\\
\\
Matriculation number:       725810\\
\par\vspace{2cm}\noindent
1st Academic Supervisor:    Prof. Dr. Herbert Krauß\\
\\
2nd Academic Supervisor:    Prof. Dr. Shun-Ping Chen\\
\\
Industrial Supervisor:      Dipl.-Ing. Hartmut Cordes\\
\par\vspace{2cm}\noindent
Completion Date:            31.10.2019
\clearpage

\tableofcontents
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Vorwort %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Vorwort}
\addcontentsline{toc}{section}{Vorwort}
Weltweit finden große Veranstaltungen statt. Bei allen Inszenierungen spielt das Licht eine 
große Rolle. Egal, ob einfach nur hell oder szenisch ausgeleuchtet, bedarf es einer Steuerung 
für diese Lichttechnik. Bühnen und Ansprüche der Veranstalter werden immer größer und komplexer. 
So geht es über das einfache An- und Ausschalten eines Scheinwerfers schon sehr weit hinaus. 
Heutzutage werden Lichtanlagen mit leistungsfähigen Computersystemen gesteuert, welche von 
geschultem Personal bedient werden müssen.\\
In der Filmindustrie spielt Licht eine große Rolle. Die Ausleuchtung eines Film-Sets entscheidet 
auch wie die Handlung vom Betrachter wahrgenommen wird. Dies gilt sowohl für statische Szenen, 
als auch für die zumeist hoch aufwändigen dynamischen Installationen.
Eine der zurzeit größten Herausforderungen stellt die korrekte Farbwiedergabe der mannigfaltigen 
Lichtquellen an einem Film-Set dar.
Dies wird vor allem durch die unterschiedlichen chromatischen Eigenschaften von den Licht 
emittierenden Quellen erschwert. Diese Quellen sind heute überwiegend LEDs.\\
Als Beispiel wird hier ein Film-Set für eine Motorrad Verfolgungsszene genommen. Hier wird im 
Hintergrund mit großen LED Kacheln der computergenerierte Hintergrund abgespielt. Mit kleinen 
LED Streifen links und rechts neben dem im Studio aufgebauten Motorrad wird dynamisch Licht auf 
den Schauspieler emittiert, um eine größere Dynamik zu simulieren.
Zusätzlich wird mit kleinen Bildschirmen weiterer computergenerierter Hintergrund von vorne auf 
das Motorrad und den Schauspieler projiziert, um realistische Spiegelungen in der 
Windschutzscheibe und der Brille des Schauspielers zu erhalten.\\
Alle diese aufgezählten Emitter haben zumeist alle unterschiedlichste chromatische Kennwerte 
sofern diese überhaupt bekannt sind. Ein Abgleich dieser Quellen ist wünschenswert für ein 
homogeneres Farbbild.

%%%%%%%%%%%%%%%%%%%%%%%%%% Erklärung %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Erklärung}
\addcontentsline{toc}{section}{Erklärung}
Ich versichere hiermit, dass ich die vorliegende Arbeit selbständig verfasst und keine anderen
als die im Literaturverzeichnis angegebenen Quellen benutzt habe.\\
Alle Stellen, die wörtlich oder sinngemäß aus veröffentlichten oder noch nicht veröffentlichten
Quellen entnommen sind, sind als solche kenntlich gemacht.\\
Die Zeichnungen oder Abbildungen in dieser Arbeit sind von mir selbst erstellt worden oder mit
einem entsprechenden Quellennachweis versehen.\\
Diese Arbeit ist in gleicher oder ähnlicher Form noch bei keiner anderen Prüfungsbehörde
eingereicht worden.\\
\par\vspace{2cm}\noindent
Darmstadt, den 30.10.2019 \hspace*{0pt}\hfill Oliver Becker
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Abstrakt %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Abstrakt}
\addcontentsline{toc}{section}{Abstrakt}

\section*{Abstract}
\addcontentsline{toc}{section}{Abstract}
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% MA Lighting Technology %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{MA Lighting Technology}
MA Lighting Technology GmbH (im Folgenden MA) wurde 1983 von Michael Adenau zusammen mit
den drei Mitgesellschaftern Ernst Ebrecht, Thomas Stanger und Werner Hauptvogel gegründet. MA
entwickelt und produziert Lichtsteuerungen für die Bereiche Fernsehen, Veranstaltungen, Theater
und szenische Gebäudebeleuchtung. Schon Anfang der 1990er Jahre erkannten die Firmengründer
das Potenzial der elektrischen und digitalen Steuerung von Scheinwerfern und bauten die ersten
Lichtstellpulte, sowie die zugehörigen Komponenten. Im Laufe der Jahre entwickelte sich MA zu
einem der international führenden Unternehmen für computergesteuerte Lichtstellpulte,
Netzwerkkomponenten und digitale Dimmer Systeme.\\
In der Referenzliste von MA findet man viele große internationale Theater und Opernhäuser, Bands
von AC/DC über Sting bis U2, die Eröffnungsfeier der Olympischen Spiele, den Eurovision Song
Contest 2019 oder die Lichtinstallation zum 25. Jahrestag des Falls der Berliner Mauer 2014.\\
\begin{wrapfigure}{r}{0.5\textwidth}
    \vspace{-25pt}
    \begin{center}
        \includegraphics[width=0.48\textwidth]{images/csm_MA_building_WBB.jpg}
    \end{center}
    \vspace{-20pt}
    \caption{Firmensitz Waldbüttelbrunn}
    \vspace{-15pt}
\end{wrapfigure}
Der Hauptsitz der MA Lighting Technology GmbH befindet sich in Waldbüttelbrunn in der Nähe von
Würzburg. Dort beschäftigt MA circa 100 Mitarbeiter. In den fünf Gebäuden befinden Soft- und
Hardwareentwicklung, Testabteilung, Produktion, Lager und Management. Alle Produkte werden
größtenteils von Hand von den Mitarbeitern vor Ort zusammengebaut. Platinen und Gehäuse werden
von externen Firmen geliefert. Die einzelnen Bauteile werden von den Mitarbeitern auf den
Platinen aufgesteckt und verlötet. Anschließend werden die bestückten Platinen in den Gehäusen
montiert und verkabelt. Nach einem mehrtägigen BurnIn-Test und einer Werkskonfiguration werden
die Geräte verpackt und sind versandfertig.\\
\\
Kundensupport und Vertrieb werden in Deutschland von der externen Firma MA Lighting International
durchgeführt. Diese hat ihren Sitz in Paderborn. Die Konsultation der Mitarbeiter in
Waldbüttelbrunn erfolgt lediglich bei größeren technischen Fragen und Problemen.\\
Eines der ersten Produkte von MA war der Lightcommander24, eine analoge Lichtsteuerkonsole auf
Basis des \ac{dmx} Protokolls von 1990. Nach kurzer Zeit folgten Dimmer für
Scheinwerfer und \ac{dmx}-Demultiplexer, um analoge Geräte ansteuern zu können.\\
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{images/grandMA_1.png}
        \caption{grandMA ful-Size}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{0.25\textwidth}
        \includegraphics[width=\textwidth]{images/MA_2Port_Node_onPC_13019x.png}
        \caption{2Port Node}
    \end{subfigure}
    \caption{grandMA 1 Serie Produkte}\label{fig:gma1}
\end{figure}
\noindent
Ebenso entwickelte MA die Steuerpulte Scan-Commander und die grandMA Series 1 sowohl als
Konsole, als auch als Computerapplikation. Das Besondere an dieser Technologie ist, dass \ac{dmx}-Daten
nicht nur über \ac{xlr}, sondern auch über ein eigenes Ethernet-Netzwerkprotokoll namens 'MA-Net'
ausgegeben werden. Als Gegenstück am anderen Ende des Netzwerkkabels existieren sogenannte
\ac{dmx}-Nodes. Diese fungieren als Protokollwandler zwischen MA-Net und \ac{dmx}.\\
Die Firma setzte immer wieder Standards in der Branche. Im Zuge des technischen Fortschritts –
Einsatz von \ac{led}s als Lichtquelle, moderne Netzwerktechnologie und Videodatenverarbeitung –
wurde die Produktpalette wesentlich erweitert. Hinzu kam die grandMA2 Series.\\
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{images/MA_grandMA2_full-size.png}
        \caption{grandMA2 full-size}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/MA-VPU-plus_d.png}
        \caption{VPU}
    \end{subfigure}
    \caption{grandMA 2 Serie Produkte}\label{fig:gma2}
\end{figure}
\noindent
Die grandMA2 Series ist die moderne Fortführung der grandMA Series 1. Außerdem stellt sie
folgende Produkte bereit: Die Network Processing Unit (NPU), eine Prozessoreinheit, welche die
Konsole in ihren Berechnungen unterstützt, indem die Konsole Rechenaufträge auf die NPU dezentral
auslagert. Die Video Processing Unit (VPU) verarbeitet Video-Content und gibt diesen nativ über
Grafikkarten oder Pixelmapping mit Hilfe von \ac{dmx} aus. Die Replay-Unit (RPU) ist eine vollwertige
Konsole ohne die typischen Steuerelemente, sie dient beispielsweise als Havariegerät. Zuletzt noch
verschiedene Variationen der Nodes, welche weiterhin als Protokollwandler dienen.\\
Alle diese Produkte adressieren vor allem den Highend-Profibereich für Theaterproduktionen,
Liveshows und Festinstallationen.\\
\begin{figure}[H]
    \includegraphics[width=\textwidth]{images/grandMA3-full-size.png}
    \caption{grandMA3 full-size}\label{fig:gma3}
\end{figure}
\noindent
Seit Mitte 2017 entwickelt MA eine neue Produkt Serie. Die grandMA3 Serie. Diese Serie greift die
in den letzten 34 Jahren gesammelte Erfahrung auf, jedoch wurde jede Zeile Code neu geschrieben,
um die technischen Möglichkeiten der neuen Hardware vollumfänglich nutzen zu können.\\
Neben vielen Veränderungen gegenüber den Vorserien arbeitet die Farblogik der grandMA3 Software
mit den Spezifikationen des \ac{cie} 1931 Standards.
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Grundlagen %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Grundlagen}
In dieser Arbeit werden Lichtquellen mit der grandMA3 Applikation von MA Lighting über ein Protokoll
mit der Bezeichnung \ac{dmx} angesteuert.\\
Für eine erste Überprüfung geeigneter Hardware wurde mit einer kleinen Demo Applikation gearbeitet. Diese wurde
in JavaScript und \ac{html} mit Hilfe des Electron Frameworks erstellt.\\
Weiter wird diese Applikation für die Ausgabe von \ac{dmx} genutzt.\\
Im folgenden werden die hier verwendeten Protokolle, Programme, und Frameworks dargelegt.

\subsection{DMX}
Diese Abkürzung steht für Digital Multiplex. Dahinter verbirgt sich ein digitales Steuerprotokoll,
welches vornehmlich in der Veranstaltungstechnik eingesetzt wird. Es wurde zuerst als DMX-
512/1990 standardisiert. Im November 2004 wurde dieser Standard aktualisiert, bekannt als
DMX512-A (ANSI E1.11-2008). \ac{dmx} basiert elektrisch auf dem seriellen RS-485 (EIA-485)
Schnittstellenstandard.\\
\begin{figure}[H]
    \includegraphics[width=\textwidth]{images/dmx.png}
    \caption{Physikalische Übertragung DMX-512/1990 (RS-485)}
\end{figure}
\noindent
Das eigentliche Signal wird dabei seriell auf einem Leitungspaar symmetrisch übertragen - auf der
einen Leitung mit invertierten und auf der anderen mit nichtinvertiertem Pegel. Das Signal ist so
weniger störungsempfindlich, da sich externe Einstreuungen auf beide Datenleitungen gleichmäßig
auswirken und am Empfänger nicht das Pegelniveau, sondern die Pegeldifferenz ausgewertet wird.
Das ermöglicht laut Standard [2] bis zu 1200m lange Übertragungsstrecken und eine
Datenübertragungsrate bis zu 12 \ac{MBps}. Ein Netzwerk aus mehreren Geräten wird als Bus aufgebaut.\\
Die Datenübertragung erfolgt mittels einer \ac{uart} gesteuerten asynchronen seriellen Schnittstelle. Ein
Datenframe besteht aus acht Datenbits und zwei Stoppbits. Die Symbolrate beträgt 250 kBaud (Baud = Bits pro sec).
\begin{figure}[H]
    \includegraphics[width=\textwidth]{images/DMX_zeitlich.png}
    \caption{Zeitliche Darstellung \ac{dmx}-Signal}
\end{figure}
\noindent
\begin{table}[H]
    \small
    Legende zu Bild 6:\\
    \begin{tabular*}{\textwidth}{l @{\extracolsep{\fill}} llllll}
        Nr. & Signalabschnitt & Min & Soll & Max & Einheit\\
        1 & BREAK & 88 & 176 & - & $\mu$s\\
        2 & MARK after BREAK & 8 $\mu$s & - & < 1 s\\
        3 & Slot Time & 43,12 & 44,0 & 44,88 & $\mu$s\\
        4 & Startbit & 3,92 & 4,0 & 4,08 & $\mu$s\\
        5 & LSB (niederwertigstes Datenbit) & 3,92 & 4,0 & 4,08 & $\mu$s\\
        6 & MSB (höchstwertiges Datenbit) & 3,92 & 4,0 & 4,08 & $\mu$s\\
        7 & Stoppbit & 3,92 & 4,0 & 4,08 & $\mu$s\\
        8 & MARK Inter-Slot Time & 0 & - & < 1 & s\\
        9 & MARK before BREAK & 0 & - & < 1 & s\\
        10 & BREAK – BREAK (Übertragungsausfall) & 1,2 ms & - & 1,25 s & s\\
    \end{tabular*}
\end{table}
\noindent
Ein \ac{dmx}-Paket beginnt mit mindestens 88 $\mu$s (22 Bitlängen) niedrigem Pegel (logisch 0) – dieser
Abschnitt wird 'BREAK' genannt. Durch ihn wird eine einfache Erkennung des Paketanfangs
ermöglicht, da quasi jeder handelsübliche UART den Break als ungültiges Datenbyte mit fehlenden
Stoppbits meldet. Darauf folgt 'MARK after BREAK' mit mindestens 8 $\mu$s (2 Bitlängen) hohem Pegel /
Ruhezustand des Daten-Busses (logisch 1). In dieser 'MARK'-Zeit können sich langsamer getaktete
Controller auf ein neues \ac{dmx}-Paket einstellen. Dann wird das Startbyte mit dem Wert 0 für \ac{dmx}
übertragen. Das Startbyte ist der Slot 0. Anschließend werden die anderen 512 Slots mit den
relevanten \ac{dmx}-Daten gesendet. Es können, müssen aber nicht alle 513 Slots übertragen werden.
Eine Adressierung der Slots ist jedoch nicht möglich – der zweite gesendete Slot ist für den ersten
Kanal, der dritte Slot für den zweiten Kanal etc.. Sollte die Übertragung zu einem beliebigen
Zeitpunkt unterbrochen werden, kann sie durch das Senden eines neuen \ac{dmx}-Paketes wieder
aufgenommen werden. Die 'BREAK'-Sequenz führt automatisch zu einem Zurücksetzen aller noch
offenen Übertragungen.\\
In der Spezifikation DMX512-A wurden erstmals Maximalzeiten für die Slot Time (3) und den
zeitlichen Abstand zwischen zwei BREAKs (10) definiert. Wenn die Zeit zwischen zwei BREAKs größer
als eine Sekunde ist, wertet ein Empfänger dies als Übertragungsausfall. Ein Übertragungsausfall ist
folgendermaßen definiert: 'Ein Übertragungsausfall kann dann angenommen werden, wenn der
angeschlossene Empfänger nicht innerhalb der angegebenen Zeit einen gültigen BREAK mit
darauffolgendem NULL-Startcode erkennen kann.' Weiter wurde eine empfohlene Länge des
BREAKs definiert. Dies soll den Empfängern die Dekodierung erleichtern.
\clearpage

\subsection{Art-Net}
Art-Net ist ein Netzwerkprotokoll, dass zur Verteilung von \ac{dmx} und \ac{rdm} Daten genutzt werden kann.
Es ist in OSI Layer 4 auf UDP aufgebaut. Das Protokoll ist von der Firma Artistic Licence Holdings Ltd. lizenziert.\\
In dieser Arbeit wird Art-Net in der dritten Version verwendet. Diese Version wurde 2011 publiziert.\\
Über das Art-Net 3 Protokoll können bis zu 32.768 \ac{dmx} Universen verwaltet werden.\\
\cite{artnet}\\
Das Protokoll kann sowohl Unicast, Multicast oder Broadcast eingesetzt werden. Somit können auch komplexe Netzwerke
in einer physikalischen Struktur aufgebaut werden.\\
\\
Mit Hilfe von Protokollwandlern wie dem MA xPort Node kann Art-Net in \ac{dmx} umgewandelt werden. Auch von anderen
Herstellern gibt es auf dem Markt weit verbreitete Protokollwandler.\\
\\
Art-Net IP Adressen sind nach folgendem Muster aufgebaut:
\begin{table}[H]
    \begin{tabular*}{\textwidth}{l @{\extracolsep{\fill}} lllll}
        Bytes & 4 & 3 & 2 & 1\\
        IP Adresse & Netz & Netz & Host & Host\\
        Subnetz & 255 & 255 & 0 & 0\\
    \end{tabular*}
\end{table}
\noindent
In der Regel werden IP Adressen für Art-Net mit dem Netz 2.X.X.X oder 10.X.X.X verwendet. Art-Net wird über den
Netzwerkport 6454 gesendet und empfangen.\\
Ein Art-Net Paket kann verschiedene Informationen enthalten. Hier sendet die Applikation jedoch
lediglich ArtDmx Pakete. Diese Pakete transportieren DMX Daten. Hier ist der Aufbau des ArtDmx Paketes dargelegt.\\
\begin{table}[H]
    \begin{tabular*}{\textwidth}{l @{\extracolsep{\fill}} lll}
        Byte Offset & Name & Größe & Beschreibung\\
        0 & ID & 8 & Art-Net\\
        8 & OpCodeLo & 1 & Pakettyp (ArtDmx) LSB\\
        9 & OpCodeHi & 1 & Pakettyp (ArtDmx) MSB\\
        10 & ProtVer & 2 & Protokollversion (14)\\
        12 & Sequenz & 1 & Paketsequenznummer\\
        13 & Physical & 1 & Physikalischer Port\\
        14 & Universe & 2 & Art-Net Universum\\
        16 & Length & 2 & Länge der DMX Daten\\
        18 & Data[] & 2-512 & DMX Daten\\
    \end{tabular*}
    \caption{Aufbau des ArtDmx Pakets}\label{tab:ArtDmxDefinition}
\end{table}
\noindent
\cite{artdmx}
\clearpage

\subsection{HTML, JavaScript, CSS}
\ac{html} ist eine Strukturbeschreibungssprache. Sie ist an den \ac{xml} Standard angelehnt. \ac{html}
wird hauptsächlich in der Webentwicklung verwendet. Doch kann \ac{html} auch für webgestützte Desktop
Applikationen genutzt werden.\\
Die Sprache enthält grundlegende Elemente zur Beschreibung von Tabellen, Einbindung von Medieninhalten sowie
von weiteren HTML Dateien.\\
Allerdings ist das erzeugte Ergebnis (zum Beispiel von einem Webbrowser) meist statisch. Als Beispiel ändert sich
der Inhalt nicht mit dem Vergrößern oder Verkleinern des Webbrowsers für eine bessere Lesbarkeit. Um solche heute
gewohnten Effekte zu erzeugen, benötigt man \ac{css} oder JavaScript.\\
\\
\ac{css} ist eine in der \ac{json} Notation geschriebene Sprache. Hier kann auf Elemente in einem \ac{html} Baum
verwiesen werden, und mit verschiedenen Attributen das Erscheinungsbild im Webbrowser oder in der Applikation
geändert werden.\\
Einfache Dinge wie Hintergrund- oder Textfarben bis hin zu komplexen Animationen können mit \ac{css} beschrieben
werden.\\
\\
JavaScript ist eine Skript Sprache, die wie \ac{css} meist in der Webentwicklung verwendet wird, kann jedoch
mit einer entsprechenden JavaScript Laufzeitumgebung auch ohne Browser auf Endgeräten ausgeführt werden.\\
Bei dieser Arbeit muss zwischen zwei Arten der Nutzung der Sprache JavaScript unterschieden werden:\\
\begin{addmargin}[2em]{0em}
 - Webcode, welcher innerhalb des Webbrowsers augeführt wird.\\
 - Appcode, welcher mit der NodeJS Laufzeitumgebung auf dem Endgerät ausgeführt wird.\\
\end{addmargin}
NodeJS ist eine JavaScript Laufzeitumgebung. Laufzeitumgebungen sind zum Ausführen eines Programms in einer
Sprache zwingend erforderlich.\\
Webcode kann dynamisch auf einer Website durch anklicken eines \ac{html} Elements weitere HTML Elemente erzeugen,
oder existierende manipulieren oder löschen. Somit kann eine Benutzereingabe das gesamte Erscheinungsbild ändern,
ohne eine andere \ac{html} Seite aufzurufen.
Zusätzlich bieten Webbrowser sogenannte "'Storages"' oder Speicher. Dort können mit JavaScript Daten gespeichert werden,
um diese zum Beispiel beim nächsten Aufruf dieser Seite weiter zu nutzen.\\
Appcode hat gegenüber Webcode weitreichendere Befugnisse auf dem Endgerät wie Dateisystemzugriff und Zugriff auf
externe Schnittstellen, wie USB oder herkömmliche serielle Schnittstellen (COM).
\clearpage

\subsection{Electron}
Electron ist ein Framework, welches zum Erstellen von Desktop Anwendungen genutzt werden kann. Electron funktioniert
wie ein Webbrowser. Die Applikation zeigt \ac{html} und andere Textinhalte an.\cite{electron} Der Programmierer kann diese
Browserumgebung nach Belieben modifizieren und erweitern. Electron wurde aus dem Projekt Atom Editor von Github entwickelt.\\
Das Framework basiert auf dem Chromium Projekt von Google. Auf dem Chromium Projekt basiert auch der Chrome Webbrowser von
Google.\\
Das Electron Framework bietet eine betriebssystemübergreifende Applikation als Resultat. Electron Applikationen können unter
Windows, Linux und MacOS ausgeführt werden.\\
Electron ist Open Source Software und wird von einer breiten Community weltweit permanent weiterentwickelt.\cite{electron} Das Projekt wird
in den Programmiersprachen C++ und JavaScript geschrieben. Der JavaScript-Anteil wird mit NodeJS auf den Zielcomputern ausgeführt.\\
Electron selbst wird als Paket angeboten. Dies ist üblich für Open Source NodeJS Projekte. Ein Paket kann in ein Projekt eingebunden werden,
vergleichbar mit einem SDK und einer DLL für C++. In der Regel werden diese Pakete über den Netzwerk-Paket-Manager oder auch \ac{npm} von
Servern abgerufen. Weiter managed \ac{npm} die installierten Pakete pro Projekt, wie Versionen jedes Paketes, sowie das aktualisieren.

\subsection{Git und Github}
Git ist eine Datei Versionierungs- und Management Software. Git wird häufig in der Software Entwicklung mit mehreren Stationen eingesetzt.\\
Eine Instanz von einem mit Git verwalteten Dateisystem wird Repository bezeichnet. Diese Instanz wird meist auf einem Server bereitgestellt.
Ein Nutzer kann den Inhalt des Repositories auf sein Endgerät abrufen.
Abgerufene Dateien, vornehmlich nicht binäre Textdateien, können anschließend lokal auf einem Endgerät editiert werden. Wenn eine neue Version
der Datei in das Repository eingestellt werden soll, werden die Änderungen an den Dateien mit einem Kommentar eingestellt (committed).
Diese eingestellten Änderungen werden dann mit dem Server synchronisiert und mit den Änderungen von anderen Stationen automatisch zusammengeführt.\\
\\
Dieses System macht das Entwickeln einer Software mit mehreren Entwicklern deutlich einfacher.\\
\\
Github ist eine Webplattform, welche kostenlos öffentliche Repositories hosted. Dort wurde auch das Git Repository der Applikation
dieses Projektes gehostet.\\
Zusätzlich bietet Github ein Projektverwaltungssystem.
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Lichtquellen %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Lichtquellen}
\subsection{Licht und Licht messen} \label{light and measurement}
Der Begriff Licht bezeichnet den Teil des elektromagnetischen Spektrums, welcher mit dem menschlichen Auge zu erfassen ist.\\
\\
Licht besteht aus rein physischer Betrachtungsweise aus Wellen im elektromagnetischen Spektrum und Teilchen. Dieses Phänomen, dass sich
Licht sowohl in der Ausbreitung wie eine Welle, als auch gleichzeitig ein wie Teilchen verhält, nennt sich Welle-Teilchen-Dualismus.
Dieser Begriff wurde durch Albert Einstein und Max Planck begründet. In dieser Theorie wird Licht als Quantenobjekt
beschrieben. \cite{wikiLicht}\\
\begin{wrapfigure}{r}{0.5\textwidth}
    \vspace{-25pt}
    \begin{center}
        \includegraphics[width=0.48\textwidth]{images/Elektromagnetisches-Spektrum.png}
    \end{center}
    \vspace{-20pt}
    \caption{Licht im elektromagnetischen Spektrum \cite{spectrumLight}}
    \vspace{-15pt}
\end{wrapfigure}
\noindent
Licht ist im elektromagnetischen Spektrum messbar. Somit kann man einen Farbton als eine Frequenz und eine Helligkeit als eine Amplitude beschreiben.
Wo eine Farbe im elektromagnetischen Spektrum einzuordnen ist, wird sie mit der Wellenlänge in Nanometern (nm) angegeben. Diese Zahl fällt von
dem Infrarotbereich des Spektrums ab 760 nm bis in den Ultraviolettbereich bei 380 nm.
\begin{align}\label{Equ:1}
    \lambda = \frac{c}{f}
\end{align}
Die zugehörigen Frequenzen liegen mit (\ref{Equ:1}) bei etwa 394,5 \ac{thz} für Infrarot und circa 789 \ac{thz} für Ultraviolett. Das
entspricht einer Bandbreite von 394,5 \ac{thz}, die das menschliche Auge erfassen kann.\\
\\
Dieser Teil des elektromagnetischen Spektrums lässt sich zum Beispiel mit Photodioden messen. Sensoren, welche eine solche Aufgabe erfüllen,
werden allgemein als Spektralsensoren bezeichnet.
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Farbe %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Farbe}
Der Begriff Farbe, als Sinneseindruck, beschreibt die verschiedenen Zustände, welche die Amplituden im elektromagnetischen Spektrum annehmen können. Hier ist es
unerheblich, ob nur eine einzelne Spekrallinie oder eine breite spektrale Verteilung betrachtet wird.\\
Der Farbeindruck wird vorallem durch den Farbton geprägt. Ein Farbton entsteht natürlich oder künstich von einem emittierenden oder reflektieren Körper.
Weiter ist die Sättigung ein entscheidendes Merkmal einer Farbe. Umso intensiver ein Farbton ist, desto höher ist die Sättigung der Farbe. Ein blasser
Farbton beinhaltet in seinem Spektrum einen Weiß-Anteil. Je blasser der Farbton, desto mehr Weiß-Anteile enthält er. Zuletzt ist noch die Helligkeit zu
nennen. Sie drückt die Intensität der Lichtempfindung einer Farbe aus und ist mit der Farbempfindung fest verknüpft.
\subsection{Farbtemperatur}
Der Begriff der Farbtemperatur ist durch den planckscher Strahler begründet. Es wurde beobachtet, dass beim starken Erhitzen eines Metalls
sich die Farbe des Metalls verändert. Ab einer Temperatur von etwa 923 Kelvin (K), also 650 Grad Celsius, fängt das Metall an rot zu glühen. Bei
weiterem Erhöhen der Temperatur wechselt der Farbton des Metalls über gelb zur sogenannten Weißglut ab rund 1300 Celsius (1573 K).
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=.8\textwidth]{images/thermal_radiation_figure.png}
    \end{center}
    \caption{Farbtemperatur Darstellung \cite{wikiFarbtemperatur}}
\end{figure}
\noindent
Dieses Prinzip der Lichtemittierung wird auch Temperaturstrahlung genannt.\\
Somit wird auch heute bei \ac{led}s noch die Farbtemperatur bestimmt und in Kelvin angegeben, auch wenn die Lichtemittierung nicht auf der
Temperaturstrahlung basiert.
\subsection{Farbmischung}

\subsubsection{Additiv}
\subsubsection{Subtraktiv}
%\cite[62 - 63]{lichtquellen}
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Menschliches Farbsehen %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Menschliches Farbsehen}
Das menschliche Auge besitzt zwei Arten von "'Sensoren"', oder auch Rezeptoren. Stäbchen zur Helligkeitswahrnehmung bei Nacht und
Zapfen zur Helligkeits- und Farbwahrnehmung bei Tag. Das Verhältnis von Zapfen zu Stäbchen beträgt im Schnitt 20:1.\\
Somit ist das Sehen bei Tag ca. sieben Mal so hoch aufgelöst wie bei Nacht.\\
Ähnlich wie verschiedene Photodioden, welche einzelne Spektralbereiche abdecken, decken auch die Zapfen nur einen
bestimmten Bereich im Farbspektrum ab. Es gibt drei verschiedene Arten von Zapfen. S-, M-, und L-Zapfen. Also "'Short"',
"'Middle"' und "'Long"' Zapfen. Die Längenangaben beziehen sich auf den Wellenlängenbereich, auf welchen die Zapfen
resistiv sind.\\
\begin{figure}[H]
    \includegraphics[width=\textwidth]{images/eye_spectrum.png}
    \caption{Darstellung des sichtbaren Farbspektrums der Zapfen des Auges}\label{fig:eye_spectrum}
\end{figure}
\noindent
Die Mengenverteilung der verschiedenen Zapfenarten liegt circa bei S:M:L 1:16:32.
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Farbräume %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Farbräume}
\subsection{Farbspektrum}
Wie bereits in \ref{light and measurement} beschrieben ist das Farbspektrum die Entsprechung des Wahrnehmungsbereiches des menschlichen
Auges im elektromagnetischen Spektrum.
\begin{figure}[H]
    \includegraphics[width=\textwidth]{images/farbspektrum.png}
    \caption{Darstellung des sichtbaren Farbspektrums \cite{fhtEsslignen}}
\end{figure}
\subsection{sRGB}
\subsection{CIE} \label{section_CIE}
\subsubsection{CIE 1931}
\subsubsection{CIE 1976}
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% LED %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{LED}
\subsection{Allgemein}
\ac{led} ist das Acronym für Light Emitting Diode, also lichtemittierende Diode. Dies ist eine spezielle Art von Halbleitern,
welche bei einem Stromfluss Licht emittieren. Die chemische Zusammensetzung (Dotierung) der Diode entscheidet, welche Farbe
beziehungsweise welche Frequenz sie emittiert.\\
Im folgenden ein Auszug der Element-Farbzuordnung \cite{wikiLed}:
\begin{table}[H]
    \small
    \begin{tabular*}{\textwidth}{l @{\extracolsep{\fill}} ll}
        Element & Farbe & Wellenlänge (nm)\\
        Aluminiumgalliumarsenid (AIGaAs) & Rot, Infrarot & 665 - 1000\\
        Galliumarsenidphosphid (GaAsP) & Rot, Orange und Gelb & 570 - 760\\
        Galliumphosphid (GaP) & (Gelb-)Grün & 500 - 580\\
        Indiumgalliumnitrid (InGaN) &  Grün, Blau, Violett und Ultraviolett & 520 - 230\\
    \end{tabular*}
\end{table}
\noindent
Zunächst wurden \ac{led}s in den frühen 1960er Jahren als Leuchtindikatoren benutzt. Also zum Beispiel auf
Platinen als Statusanzeige oder wie wir es heute von vielen Ethernetanschlussbuchsen kennen als blinkende Anzeige, die den Datenempfang
signalisiert. Durch die voranschreitende technische Entwicklung der \ac{led}, wie bessere Effizienz und bessere Lichtausbeute, sowie verbesserter
Langlebigkeit des Bauteils, fand anfang der 1990er die \ac{led} auch ihre Anwendung im Heimbereich.\\
\ac{led}s emittieren Licht in einem begrenzten Spektralbereich. Das Licht ist nahezu monochromatisch. Deshalb sind sie beim Einsatz als
Signallicht besonders effizient im Vergleich zu anderen Lichtquellen, bei denen zur Erzielung einer monochromen Farbcharakteristik
Farbfilter den größten Teil des Spektrums absorbieren müssen.\\
\cite{showlicht} %// TODO: Quotes

\subsection{Mischen von Farben}\label{colormixing}
Emittierende Körper unterliegen der additiven Farbmischung. Dies bedeutet, dass sich die ins elektromagnetische Spektrum abgegebenen
Wellen bei ihren jeweiligen Wellenlängen aufaddieren. Somit kann mit verschiedenen LED Lichtquellen eine neue Farbe gemischt
werden.\\
So kann beispielsweise mit einer roten und einer grünen \ac{led} ein orangener bis gelber Farbton gemischt werden.

\subsection{Weiße LEDs}
Eine tatsächlich weiße \ac{led} existiert bisher auf dem Markt nicht, da \ac{led}s generell schmalbandig abstrahlen. Die heutzutage
verwendeten "'weißen"' \ac{led}s sind eigentlich blaue \ac{led}s, mit einem zusätzlichen Phosphor Filter als breitbandigem Lumineszenzfarbstoff.
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/LED_weiss_P_blau.png}
        \caption{Funktionelles Blockdiagramm}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/LED_weiss_phosphor.png}
        \caption{Spektrale Abdeckung}
    \end{subfigure}
    \caption{Weiße LED - Aufbau und Spektrum \cite{wikiLed}}\label{fig:White LED}
\end{figure}
\noindent
Dies verschiebt das abgestrahlte Licht in den gelben Bereich. Somit entsteht mit einem Teil des blauen Lichts und mit dem farbverschobenen Spektrum
ein breitbandiges Abstrahlverhalten.
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Lichtquellen in der Veranstaltungstechnik %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Lichtquellen in der Veranstaltungstechnik}
Für die Veranstaltungstechnik ist künstliches Licht nahezu unverzichtbar. Von der Grundausleuchtung in einem Theater bis zum Effektlicht
auf Kleinveranstaltungen. In den frühen Jahren der großen Konzerte wurde die Bühne hauptsächlich mit Scheinwerfern mit Glühfaden Leuchtmitteln beleuchtet.
Diese Form der Beleuchtung wurde in der Veranstaltungstechnik als Kunstlicht bezeichnet.\\
Weiter werden vornehmlich in Theatern, sowie Film- und Fernseherproduktion Tageslichtscheinwerfer benutzt. Tageslichtleuchtmittel
unterscheiden sich von der Art der Lichterzeugung gegenüber Glühlicht. Hier kommen anstatt eines Glühfadens zwei Elektroden in einer
gasgefüllten Röhre zum Einsatz. Mit dem Anlegen einer Spannung an den beiden Elektroden baut sich ein elektrisches Feld auf, welches zu
einer Gasentladung und somit zu einer Lichtemittierung führt. Solche Gasentladungslampen oder auch \ac{hmi} (Halogen-Metalldampflampe)
werden für diese Anwendungen in der Regel mit Xenon befüllt. Das emittierte Licht ist ähnlich dem Spektrum des Sonnenlichtes auf der
Erde. Daher der Name Tageslichtscheinwerfer.
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/conventional_spectrum.png}
        \caption{Glühlichtlampe}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/HMI_Spectrum.png}
        \caption{Gasentladungslampe}
    \end{subfigure}
    \caption{Typische Spektren der verschiedenen Leuchtmittel \cite{showlicht}}\label{fig:lightEmiiterSpects}
\end{figure}
\noindent
In den 2000er Jahren hielt dann die LED Einzug in die Welt der Veranstaltungstechnik. Damit begann ein Wandel besonders im Bezug auf die Lebensdauer
der Leuchtmittel und der Lichtausbeute im Vergleich zum Stromverbrauch. Mit der fortschreitenden Entwicklung der \ac{led} und der
Scheinwerfer, welche diese nutzen, hat die \ac{led} heute an vielen Stellen die konventionelle Glühlampe oder \ac{hmi} verdrängt.\\
Die Lebensdauer einer auf \ac{led}-Technik basierenden Lampe liegt im Bereich von 15.000 bis 45.000 Betriebsstunden. Eine Glühlampe hingegen
hat nur eine Lebensdauer von etwa 300 Betriebstunden. Eine Gasentladungslampe hält eine Betriebsbelastung von etwa 300 bis 2000 Stunden aus.
Eine weitere Stärke der LED ist der niedrige Stromverbrauch bei einer vergleichbaren Lichtausbeute gegenüber einer Glühlampe oder \ac{hmi}.
Ein PAR64 Medium Flood CP62 hat eine Lichtausbeute von etwa 320 Lumen mit einer Leistung von 1000 Watt \cite{convpar}. Ein vergleichbarer moderner
\ac{led} \ac{par} mit einer LED Leistung von 180 Watt hat eine Lichtausbeute von etwa 5100 Lumen \cite{ledpar}. So können heute umfangreichere
Lichtinstallationen umgesetzt werden. Da die verfügbare Leistung an Veranstaltungsorten begrenzt ist, konnte nur eine vergleichsweise geringe
Anzahl von konventionellen \ac{par} Scheinwerfern eingesetzt werden, da schon mit 100 \ac{par}s mit 1000 Watt Anschlussleistung bereits
100.000 Watt zur Verfügung stehen müssten, um alle zur gleichen Zeit zu betreiben. Dies war in der Regel nicht der Fall. Dennoch wurden in der
Vergangenheit bei Großveranstaltungen solche Stückzahlen in Bühnen verbaut und dies nicht als einziger Scheinwerfertyp.
Denn hier hat die LED einen weiteren Vorteil zu damals.\\
Früher wurden um eine Bühne in verschiedenen Farben auszuleuchten mehrere \ac{par}s benötigt. Um nur rot, grün, blau und weiß leuchten zu
können, benötigte man vier \ac{par}s. Drei davon mit einer jeweiligen Farbfolie vor dem Lichtaustritt. Farbfolien nutzen das Konzept der
subtraktiven Farbmischung. Es werden vor eine in der Regel weiße Lichtquelle hitzebeständige Folien gespannt, welche nur bestimmte Teile des 
Lichtspektrums durchlassen.\\
Dadurch war die Gesamtleistung aller eingesetzten Scheinwerfer früher deutlich größer als dem Licht für die Veranstaltung zugedacht war. Doch
da die Lampen für die verschieden Farben nie alle zur gleichen Zeit an waren, war dies nur ein Problem im Haushalten mit der zur verfügungstehenden
Leistung.\\
Mit \ac{led} Scheinwerfern gibt es dieses Problem heute kaum mehr. Die Scheinwerfer können durch das Verbauen von mehrfarbigen \ac{led}s (siehe
\ref{colormixing}) in einem \ac{led} \ac{par} mit additiver Farbmischung ein großes Repertoire an Farben bereitstellen.
Dennoch sind die Traversen auf den Großveranstaltungen voller geworden gegenüber früher.
Die ersten \ac{led} \ac{par}s hatten viele einzelne rote, grüne und blaue 5-mm-\ac{led}s. Hier war jedoch das Problem, dass bei der Farbmischung
mit beispielsweise Rot und Grün kein homogenes Gelb entstanden ist, da jede einzelne \ac{led}s ihr eigenes Streuverhalten hatte. So konnte
auf einer auftreffenden Fläche wie dem Boden immer einzelne nur rote oder nur grüne Farbflächen entstehen. Dieses unerwünschte Verhalten wurde
später gelöst, indem mehrere \ac{led}s in einen Chip integriert wurden, und vor jeden dieser \ac{led}-Chips eine Streulinse gesetzt wurde.
Somit konnte ein deutlich homogeneres Abstrahlverhalten erreicht werden.
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Verwendete Geräte %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Verwendete Geräte}
\subsection{Lampen}
Im folgenden werden die Lichtquellen beziehungsweise die Lampen beschrieben, die für die Messungen verwendet wurden.
Auch in der Veranstaltungstechnik als (engl.) "'Fixtures"' bezeichnet. Diese Lampen haben alle \ac{led}s als Lichtquelle. Diese \ac{led}s
sind alle unterschiedlich aufgebaut.
\subsubsection{Ape Labs Light Can}
~\par\vspace{-\baselineskip}
\begin{wrapfigure}{r}{0.4\textwidth}
    \vspace{-45pt}
    \begin{center}
        \includegraphics[width=.23\textwidth]{images/light_can_front.png}
    \end{center}
    \vspace{-20pt}
    \begin{center}
        \caption{Light Can\\\cite{lightCan}}
    \end{center}
    \vspace{-15pt}
\end{wrapfigure}
\noindent
Diese Lampe ist eine sehr kompakt gebaute RGBW \ac{led} Lichtquelle auf Akku Basis. Diese wurde von der Firma Ape Labs aus Eisigen in Deutschland
entwickelt. Diese Lampe ist sowohl per Fernbedienung, als auch per W-\ac{dmx} steuerbar.
Die "'Kanne"' hat einen Abstrahlwinkel von 65 Grad. Zur gezielten Steuerung, ohne vorprogrammierte Effekte wird ein \ac{dmx} zu W-DMX Wandler der
Firma benötigt (W-APP). Dieser ermöglicht dann die Ansteuerung der Lampe durch die Applikation.
\subsubsection{Robe LEDWash 300}
Dieses Wash Movinglight ist ein handelsübliches Gerät und wird weltweit bei vielen Veranstaltungen universell eingesetzt. Hier sind 19 einzelne
RGBW \ac{led}s hinter einzelnen Linsen in zwei Kreisen und einer Mittelpunkt \ac{led} positioniert.
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=.3\textwidth]{images/Robe_300_ledwash.png}
    \end{center}
    \caption{Robe LEDWash 300 \cite{robe}}
\end{figure}
\noindent
Das Movinglight hat einen einstellbaren Abstrahlwinkel von 8 bis 63 Grad. Dieser wurde allerdings bei den Messungen auf 63 Grad fest eingestellt,
um ein möglichst homogenes Abstrahlverhalten zu erhalten. Laut Hersteller hat die Lampe bei einer Distanz von fünf Metern zur Lampe eine
Lichtausbeute von 3.370 Lumen. Die Lampe ist per \ac{xlr} mit DMX, oder via Ethernet RJ45-Buchse per Art-Net steuerbar. An einem Display
am Fuß (der "'Base"') kann der Scheinwerfer konfiguriert werden.
\subsubsection{ARRI SkyPanel}
Das Skypanel S60-C von der Firma Arri, ein Tochterunternehmen der Firma Osram, wird oft als Fluter, das Grundlicht in Film und Fernsehen, eingesetzt.
Es wird beworben, dass es mit \ac{cie} 1931 xyY Werten per DMX angesteuert werden kann und diese \ac{cie} Werte von der Lampe exakt wiedergegeben werden. Somit
ist diese Lampe eine perfekte Referenz für diese Arbeit.
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=.48\textwidth]{images/skypanel_s60_c.png}
    \end{center}
    \caption{ARRI Skypanel S60-C \cite{arri}}
\end{figure}
\noindent
Das SkyPanel hat einen Abstrahlwinkel von 115 Grad. Die RGBW \ac{led}s befinden sich hinter einem lampengroßem Diffusor. Die Lampe ist per
\ac{xlr} mit DMX, W-DMX oder via Ethernet RJ45-Buchse per Art-Net steuerbar. An einem Display auf der Rückseite kann der Scheinwerfer konfiguriert
werden. Außerdem kann manuell am Gerät auch eine xyY \ac{cie} Farbe ohne externe Ansteuerung eingestellt werden.\\
Bei einer Ansteuerung per DMX oder Art-Net kann am Gerät auch abgelesen werden, welche xyY Werte das Gerät aus der Ansteuerung ermittelt,
und versucht zu emittieren.
\subsection{Messgerät MK350 LED}
Als Referenz Messgerät zu dem vergleichsweisen niedrigpreisigen Sensoren wurde das bei MA Lighting bereits vorhandene Spektralmessgerät
"'MK350 LED"' der Firma UPRtek genutzt.\\
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/MK350N_Basic_Handheld_Spectrometer.png}
        \caption{Produkt \cite{uprtek}}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/mk350_lightcan_green.JPG}
        \caption{Grafische Benutzeroberfläche}
    \end{subfigure}
    \caption{UPRtek MK350 LED}
\end{figure}
\noindent
Dieses Messgerät kann Spektraldaten im Bereich von 360 bis 760 Nanometern messen. Hier wird ein Messwert pro einem Nanometer erfasst. Daraus berechnet
das Messgerät die \ac{cie} 1931 xy Koordinaten, sowie die \ac{cie} 1976 uv Koordinaten. Messwerte können einzeln oder auch in Serie erfasst werden und
im CSV Format für die weitere Auswertung auf eine SD Karte gesichert werden.
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Sensorik %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Sensorik}
Es gibt einige Hersteller von entsprechenden Spektralsensoren für Licht und spektral benachbarte Bereiche wie Infrarot.
Ein Hersteller, dessen Sensoren in dieser Arbeit vornehmlich genutzt wurden, ist die Firma AMS.\\
Zu Beginn wurde nach einer einfachen Evaluierungslösung für das Erfassen von spektralen Daten gesucht. Hier wurde das
Sensorboard von der Firma Adafruit AS7262 genutzt. \cite{adafruit}\\
Dieses Board nutzt einen AMS AS7262 Visible Spectral Light Sensor. Weiter stellt es Pin outs für \ac{i2c} und \ac{uart} bereit,
sowie eine Status-\ac{led} und eine Referenz \ac{led} Weißlichtquelle zur Beleuchtung von nicht selbst emittierenden
Gegenständen.
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=.48\textwidth]{images/AS7262_front.png}
    \end{center}
    \caption{Adafruit AS7262 Sensorboard \cite{adafruit}}
\end{figure}
\noindent
Für eine erste Evaluierung und auch für das weitere Vorgehen wurde die UART Schnittstelle genutzt, da diese in der Kommunikation
transparenter aufgebaut ist.\\
Hier ist zu beachten, dass auf dem Adafruit Sensorboard die Lötbrücke für "'\ac{uart} SELECT"' geschlossen werden muss. Ohne diese
Anpassung verbleibt der Chip im \ac{i2c} Modus.\\
Das Sensorboard wurde mit einem "'FTDI Friend"', einem weiteren Produkt von Adafruit, mit dem Endgerät, einem Windows Computer, verbunden.
Dies ist ein USB-Seriell-Transceiver. Dieser Chip von der Firma FTDI wandelt \ac{usb} zu RS232 Analogsignalen. Die Verbindung mit dem \ac{ic}
\ac{uart} via RS232 hergestellt, mit einer Baud Rate von 115200.\\
\\
Die Kommunikation über \ac{uart} mit allen AMS Sensoren funktioniert mit AT-Kommandos, einer \ac{ascii} basierten Kommandosprache,
welche für Modems in den 1980er Jahren entwickelt wurde.

\subsection{AS7261}
Das Sensorspektrum des 7261 ähnelt sehr der Zapfenverteilung im menschlichen Auge. Die in Bild \ref{fig:AS7261_spectrum} gezeigte
Gewichtung der Sensoren ist angelehnt an die \ac{cie} 1931 Gewichtungskurven für das menschliche Auge. 
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/AS7261_functional_blockdiagram.png}
        \caption{Funktionelles Blockdiagramm}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/AS7261_spectrum.png}
        \caption{Spektrale Abdeckung}\label{fig:AS7261_spectrum}
    \end{subfigure}
    \caption{AMS AS7261 \cite{datasheet61}}\label{fig:AS7261}
\end{figure}
\noindent
Neben den \ac{cie} X, Y und Z Sensoren verfügt der Sensor noch über einen \ac{nir}, einen Dark und einen Clear Sensor. Diese finden hier
allerdings keine Verwendung.\\
Die AT Schnittstelle stellt verschiedenste Informationen zur Verfügung. Zunächst kann mit dem Befehl "'ATDATA"' die Sensorwerte als
16-Bit Integer (Ganzzahl) Werte von 0 bis 65535 ausgegeben.\\
\\
Weiter gibt es nicht (spektral) Sensor bezogene Eintellungen die über die \ac{uart} Schnittstelle abgefragt und gesetzt werden können.
Als ein Beispiel kann die Temperatur in Celsius des \ac{ic}s mit "'ATTEMP"' abgefragt werden.\\
Mit "'ATLED0=100"' kann eine kleine grüne Status \ac{led} angeschaltet werden, um zu signalisieren, dass das Programm eine Verbindung mit 
dem Chip herstellen konnte und die Kommunikation funktioniert.\\
Zusätzlich kann mit den Befehlen "'ATLED1=0"' und "'ATLED1=100"' eine auf dem Evaluationsboard angebrachte weiße Referenz \ac{led} aus und
an geschaltet werden, um nicht selbst emittierende Objekte zu vermessen.\\
Die Schnittstelle stellt noch einige weitere Informationen zur Verfügung, wie die Chip Software-Version, einen Sensor Gain, Sensor Bank Modus
und Integrationszeit.
\clearpage

\subsection{AS7262}
Auch das Sensorspektrum des 7262 ähnelt sehr der Zapfenverteilung im menschlichen Auge. Dieser \ac{ic} hat insgesamt 6 einzelne Photodioden.
Davon sind 4 im rot bis gelbgrünen Teil des Spektrums angesiedelt. Eine weitere Photodiode im grünen Spektralbereich und die letzte im blauen
Bereich. So sind auch in Bild \ref{fig:eye_spectrum} zwei der drei Zapfen Arten im rot bis grünen Bereich. Die dritte Zapfenart ist im blauen
Bereich.
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/AS7262_functional_blockdiagram.png}
        \caption{Funktionelles Blockdiagramm}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/AS7262_spectrum.png}
        \caption{Spektrale Abdeckung}\label{fig:spec_7262}
    \end{subfigure}
    \caption{AMS AS7262 \cite{datasheet62}}\label{fig:AS7262}
\end{figure}
\noindent
Hier werden aus der \ac{uart} (AT) Schnittstelle mit dem Befehl "'ATCDATA"' die Sensorwerte der einzelnen Dioden als 32-Bit floating point
(Gleitkomma Zahlen) ausgegeben. Die weiteren nicht Sensor bezogenen Befehle sind identisch mit dem Befehlssatz des AS7261 Sensors.
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Messungen %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Messungen und Testapplikation}
\subsection{Empfangen und Aufbereiten der Sensorwerte}
Zu Beginn wurde der Sensor AS7262 in Betrieb genommen, da dieser auf einem Evaluierungsboard verfügbar war.
Zunächst wurden mit der Applikation "'Putty"' über die COM Schnittstelle einige Kommandos gesendet, um die
\ac{uart} Schnittstelle zu testen. Dies ist erfolgreich gelungen. Es wurden erste spektrale Werte des
Umgebungslichtes und einer Light Can empfangen. Es wurde der Befehl "'ATDATA"' genutzt.\\
Anschließend wurde damit begonnen, eine erste NodeJS Applikation zu programmieren, um intervallweise spektrale Daten
von der \ac{uart} Schnittstelle abzufragen und anzuzeigen. So konnten erste Messwerte mit dem AS7262 Sensor erhoben werden.
Diese Messwerte wurden mit dem MK350 verglichen. Hier wurde beobachtet, dass die gemessenen Daten des MK350 auf den jeweiligen
Wellenlängen mit den Werten übereinstimmen. Hier ist anzumerken, dass - wie in Bild \ref{fig:green_spec_MK350} zu sehen - die pro Wellenlänge
gemessene Amplitude nach 1 normiert wird. Zur Vergleichbarkeit werden auch in der Applikation die Sensor Werte des AS7262 nach
1 normiert. Die Messwerte der sechs Wellenlängen des AS7262 sind mit geringer Abweichung identisch zum MK350.\\
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/mk350_lightcan_green_spectrum.png}
        \caption{Spektrum MK350}\label{fig:green_spec_MK350}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{images/app_lightcan_green_spectrum.png}
        \caption{Spektrum AS7262}\label{fig:green_spec_7262}
    \end{subfigure}
    \caption{Spektrum des grünen Emitters einer LightCan. Gemessen am 10.09.2019}
\end{figure}
\noindent
Doch war hier ein großes Defizit des AS7262 zu beobachten. Wie in Bild  \ref{fig:green_spec_MK350} zu erkennen liegt das Maximum
des grünen Emitters bei ca. 515 Nanometern. Doch liegen die beiden nächsten Messflanken des AS7262 bei 500 und 550 Nanometern (Bild \ref{fig:spec_7262}).
Somit wird der Wellenlängenbereich mit der höchsten Energiedichte nicht erfasst. Dies erzeugt eine relevante Fehlerquelle für weitere
Berechnungen.\\
Nach der Implementierung der ersten Auswertung der Messdaten eines mit der Applikation verbundenen Sensors wurde begonnen, die Messwerte in der
Applikation grafisch aufzubereiten. Zunächst wurde die NodeJS mit dem \ac{npm} Paket Electron erweitert. Auf der Appcode Seite ist ein Befehlssatz
zur Generierung eines Electron Fensters, sowie eine Abfrage des Sensors mit dem Befehl "'ATCDATA"', welcher intervallweise alle 250 Millisekunden
abgerufen wird. Die empfangenen Sensordaten werden dann per Schnittstelle an den Webcode weitergegeben.\\
Mit den im Webcode verfügbaren Sensordaten wurden in Anlehnung zu der Darstellung im MK350 die Werte mit proportional hohen Balken pro Wellenlänge
mit HTML Elementen dargestellt. Diese Balken wurden zur besseren Zuordnung in eine, die Wellenlänge repräsentierende, Farbe eingefärbt.
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=.6\textwidth]{images/app_dummy_spectrum.png}
    \end{center}
    \caption{Erste Darstellung der Sensorwerte}
\end{figure}
\noindent
Die 1 normierten Werte bezogen auf den maximal gemessenen einheitlosen Wert sind unter den Balken angezeigt. Der gemessene Maximalwert wird in der
oberen linken Ecke angezeigt. Unter den normierten Messwerten ist zusätzlich ein beschreibender Name der Farbe, sowie die Wellenlänge aufgeführt.\\
\\
Mit dieses Werten wurde begonnen, eine XYZ \ac{cie} Koordinate zu errechnen. Hier wurden die Formeln von Bruce Lindbloom genutzt. Lindbloom's Webauftritt
dient bereits in vielen Büchern und anderen Publikationen als Referenz für Themen wie Farbräume oder Umrechnung zwischen Farbräumen.\\
Zur Umrechnung eines diskreten Farbspektrums zu einer \ac{cie} XYZ Koordinate sind folgende Formeln gegeben \cite{lindbloom}:
\begin{align}\label{Equ:2}
    X = \sum_{i}x_i*P_i\Delta\lambda\\
    Y = \sum_{i}y_i*P_i\Delta\lambda\\
    Z = \sum_{i}z_i*P_i\Delta\lambda
\end{align}
Die Variablen $x_i$, $y_i$ und $z_i$ stehen hier für die Tristimuluskurven (Standard Observer Functions) oder auch Empfindlichkeitskurven aus Kapitel \ref{section_CIE}.
Eine Aufstellung der Tristimuluswerte wurde von der Website "'Wisotop"' von der Fachhochschule Köln entnommen. Die Dokumentationen der
\ac{cie} Kommission sind nicht öffentlich einsehbar.
Die hier genutzten Tristimuluswerte \cite{wisotop}:
\begin{table}[H]
    \small
    \begin{tabular*}{\textwidth}{l @{\extracolsep{\fill}} llllll}
        Wellenlänge & 450 & 500 & 550 & 570 & 600 & 650\\
        X & 0.3362 & 0.0049 & 0.4334 & 0.7621 & 1.0622 & 0.2835\\
        Y & 0.0380 & 0.3230 & 0.9950 & 0.9520 & 0.6310 & 0.1070\\
        Z & 1.7721 & 0.2720 & 0.0087 & 0.0021 & 0.0008 & 0.0000\\
    \end{tabular*}
\end{table}
\noindent
Aus diesen Werten und den mit dem Sensor erfassten Spektralwerten konnten nun die \ac{cie} XYZ Werte errechnet werden. Um nun den grafischen Punkt auf
einem \ac{cie} 1931 Diagramm zu erhalten, müssen die XYZ in xyz Koordinaten umgerechnet werden. Dies ist mit den folgenden Formeln möglich \cite{lindbloom}:
\begin{align}\label{Equ:3}
    x = \frac{X}{X+Y+Z}\\
    y = \frac{Y}{X+Y+Z}\\
    z = Y
\end{align}
Mit diesen Werten konnte nun der Punkt in das \ac{cie} 1931 Diagramm in der Applikation nach jeder Messung, also immer nach 250 Millisekunden eingezeichnet werden.
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=\textwidth]{images/app_dummy_spectrum_with_xy.png}
    \end{center}
    \caption{Darstellung der Sensorwerte und CIE 1931 Diagramm}
\end{figure}
\noindent
{\color{red}
Hier folgen Notizen:\\
- AS7261\\
- Mit dem Sensor AS7261 konnten die bisherigen Ausführungen bis zur XYZ zu xyz Konvertierung übersprungen werden\\
- Der Applikation wurde ein Sensorauswahldialog hinzugefügt\\
- Hier wurde festgestellt, dass der AS7261 folgende Vor-/Nachteile bei der Ermittlung der XYZ Werte hat\\}
\\
Zusätzlich zur Darstellung im \ac{cie} 1931 Farbraum wurde zur besseren Einordnung und zur Anzeige in der Applikation die XYZ Werte in RGB Werte
umgewandelt. Dies ist möglich mit folgenden Gleichungen von Lindblooms Webauftritt \cite{lindbloom}:
\begin{align}\label{Equ:4}
    \left[ \begin{array}{r}
        r \\
        g \\
        b \\
    \end{array}\right]
    = [M]^{-1} \left[ \begin{array}{r}
        X \\
        Y \\
        Z \\
    \end{array}\right]
\end{align}
mit sRGB Umrechnungsmatrix mit Weiss-Referenzpunk D65 %// TODO: D65 irgendwo erklären
\begin{align}\label{Equ:5}
    M^{-1} = \left[ \begin{array}{rrr}
        3.2404542  & -1.5371385 & -0.4985314 \\
        -0.9692660 & 1.8760108  & 0.0415560  \\
        0.0556434  & -0.2040259 & 1.0572252  \\
    \end{array}\right]
\end{align}
Für $M$ sind einige Definitionen gegeben. Diese gewählte Definition ist abhängig von dem RGB Farbraum, in den umgerechnet werden soll, sowie
die Weißlicht-Bezugsquelle.
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=\textwidth]{images/app_dummy_info_with_rgb.png}
    \end{center}
    \caption{Errechnete Werte aus dem Spektrum}
\end{figure}
\noindent
Mit diesen Umrechnungen sind nun alle relevanten Farbräume abgedeckt. Diese Werte werden in der Applikation angezeigt. Die Anzeige der RGB Werte
wird mit den entsprechenden Werten als Hintergrundfarbe hinterlegt.
\subsection{Aufnehmen von Messwerten}
Mit den nun verfügbaren Farbraumdaten aus einer Messung, kann mit der weiteren Verarbeitung der Daten begonnen werden. Nun können die einzelnen
Emitter vermessen und die Messdaten gesichert werden. Für eine erste Vermessung einer Light Can wurde diese mit dem WAPP per DMX angesteuert.
Für die Vermessung einer Light Can wurde folgendes Szenario definiert:
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=\textwidth]{images/light_can_holder_3d.png}
    \end{center}
    \caption{3D Modell des Messaufbaus für eine Light Can}\label{fig:3DCanHolder}
\end{figure}
\noindent
Diese in Bild \ref{fig:3DCanHolder} gezeigte Vorrichtung wurde 3D modelliert und anschließend mit einem 3D Drucker hergestellt. In die linke
Halterung kann eines der Sensorboards eingeschoben werden. Mit einem definierten Abstand von zwölf Zentimetern kann in den rechten runden Halterungen
eine Light Can arretiert werden. Dieser Abstand wurde anhand der Empfindlichkeiten der Sensoren in den ersten Probemessungen festgelegt.\\
In der Applikation wurden die Emitter der Light Can aufgelistet. Diese sind Rot, Grün, Blau und Weiß. Pro Emitter werden acht Helligkeitsstufen
gemessen, da bei den Probemessungen beobachtet wurde, dass vor allem bei niedrigen Helligkeiten der gemessene Farbton sich deutlich von dem
gemessenen Farbton bei hohen Helligkeiten unterscheidet.\\
Die gewählten Helligkeitsstufen sind:\\
5\%, 10\%, 20\%, 35\%, 50\%, 65\%, 85\% und 100\% der Helligkeit des jeweiligen Emitters.\\
Um die gemessenen Werte in der Applikation zu erfassen, wurde eine Emittersektion in der grafischen Benutzeroberfläche vorgesehen.
Der Benutzer konnte mit der Schaltfläche "'Add Emitter"' manuell Emitter zu der aktuellen Messung hinzufügen. Durch Anklicken eines angelegten
Emitters, konnte das Menü des einzelnen Emitters geöffnet werden.
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{\textwidth}
        \includegraphics[width=\textwidth]{images/app_emitters_v1.png}
        \caption{Emitter Übersicht der aktuellen Messung}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{\textwidth}
        \includegraphics[width=\textwidth]{images/app_edit_emitters_v1.png}
        \caption{Menü des einzelnen Emitters}
    \end{subfigure}
    \caption{Erste version der Benutzeroberfläche zur manuellen Erfassung von Emitterwerten}
\end{figure}
\noindent
Das Emittermenü bot einige Einstellungsmöglichkeiten wie den Namen und die Farbe zur besseren Zuordnung für den Benutzer, sowie eine Schaltfläche pro zu messende
Helligkeitsstufe. Während einer Messung musste der Benutzer nun mit einer externen (DMX) Ansteuerung, beispielsweise den roten
Emitter einer Light Can in den gewünschen Helligkeitszustand bringen. Anschließend konnte mit einem Klick auf die zugehörige Schaltfläche die
aktuell gemessenen Werte im Hintergrund abgespeichert werden. Die betätigte Schaltfläche wurde zur Bestätigung für den Benutzer in der errechneten
RGB Farbe hinterlegt.\\
Nach dem manuellen Erfassen aller Helligkeitsstufen konnten die erfassten Daten mit der Schaltfläche "'Save"' permanent auf der Festplatte zur
Weiterverwendung gespeichert werden. Dieser Vorgang musste für alle Emitter wiederholt werden.
\subsection{Vorberechnen anhand von Messwerten}
Mit den nun verfügbaren Messwerten einer Lichtquelle wurde zur Überprüfung der bisher eingesetzten Berechnungen eine Möglichkeit programmiert,
um virtuell in der Applikation die Emitter additiv zu mischen. Durch Interpolation zwischen den erfassten Helligkeitsstufen und additiver
Farbmischung den Farbton einer aktiven Emitterkombination vorauszuberechnen.
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=.9\textwidth]{images/app_emitters_with_sliders_v1.png}
    \end{center}
    \caption{Emitter Übersicht mit Schiebereglern}\label{fig:emitterFaders}
\end{figure}
\noindent
In der Benutzeroberfläche wurde dies mit Schiebereglern pro Emitter gelöst, welche von 0 bis 100 in fünf Prozent Schritten einstellbar sind.
Sobald der Benutzer einen Schieberegler betätigt, wurde das gemessene oder interpolierte Spektrum der Emitter aufaddiert. Dieses kombinierte
Spektrum wurde in eine \ac{cie} xy Koordinate umgerechnet und zusätzlich zu der aktuellen Messung in der CIE 1931 Normtafel angezeigt.
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{.49\textwidth}
        \includegraphics[width=\textwidth]{images/app_dummy_spectrum_with_xy_and_calc_and_emitters.png}
        \caption{Messung des grünen Emitters}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{.49\textwidth}
        \includegraphics[width=\textwidth]{images/app_dummy_spectrum_with_xy_and_calc_and_emitters_green_blue.png}
        \caption{Messung des grünen und blauen Emitters}\label{fig:calcLightCanMix}
    \end{subfigure}
    \caption{Zwischenstand der Benutzeroberfläche mit Messungen und Vorberechnung einer Light Can}
\end{figure}
\noindent
Die vorberechnete Koordinate wird als rotes Kreuz in der CIE 1931 Normtafel angezeigt, neben der aktuellen Messung, welche als schwarzes Kreuz
angezeigt wird.\\
Hier ist zu beobachten, dass bei einem Mischfarbton in Bild \ref{fig:calcLightCanMix} die Messung der Lichtquelle mit der Vorberechnung nicht
übereinstimmt. Bei Messungen mit den anderen Lichtquellen ist diese Abweichung nicht aufgetreten. die zwei Kreuze waren zumeist in jeder beliebigen
Kombination nahezu deckungsgleich.\\
Diese Abweichung entsteht durch eine spezielle Funktion des Light Can Scheinwerfers. Die Light Can nutzt einen internen Algorithmus, um sowohl bei
maximaler Austeuerung eines einzelnen Emitters als auch bei der Aussteuerung von mehreren Emittern immer die gleiche Gesamthelligkeit zu
emittieren.\\
So wird bei einem 100 Prozent Ansteuerung des grünen Emitters eine Helligkeit von circa 4400 Lux von dem einen Emitter abgegeben. Bei der
Kombination mehrere Emitter wird die maximale zu erreichende Helligkeit der einzelnen Emitter reduziert.\\
\\
Dieser Test zeigt, dass für lineare und annähernd lineare Farbmischsysteme eine Einzelvermessung der Emitter ausreichend ist, um den Gamut, den möglichen
Farbraum und die Farbmischung vorauszuberechnen. Für nicht lineare Farbmischsysteme sind weitere Messungen der tatsächlichen Mischfarben nötig oder der
modifizierende Algorithmus in der Lampe muss bekannt sein.
\subsection{Gamut Zeichnung}
Als Gamut bezeichnet man das Farbvermögen einer Lichtquelle. Mit den verarbeiteten Messdaten ist es möglich diesen in den CIE 1931 Farbraum für die einzelnen
Lampen einzuzeichnen.\\
Für eine beliebige Anzahl N von Emittern kann ein Polygon mit N oder weniger Ecken entstehen. Beispielsweise spannen die Emitter Rot, Grün und Blau spannen ein
dreieckiges Polygon als Gamut. Ein vierte weißer Emitter liegt innerhalb dieses Polygons, dies erweitert den Gamut nicht. Läge ein weiterer Emitter außerhalb des
bereits aufgespannten Polygons wird dies entsprechend erweitert.\\
Um einen Gamut einer Lampe in ein CIE Diagramm einzuzeichnen müssen die xy Koordinaten gegen den Uhrzeigersinn sortiert werden. Dies wird bewerkstelligt, indem
der Mittelpunkt des Polygons gesucht wird.
\begin{align}\label{Equ:6}
    Center_x = \frac{\sum_{i}Vertex_{ix}}{i}\\
    Center_y = \frac{\sum_{i}Vertex_{iy}}{i}
\end{align}
Anschließend werden die Winkel der einzelnen Koordinaten zu dem gefundenen Mittelpunkt errechnet werden.
\begin{align}\label{Equ:7}
    \phi = arctan2(Vertex_x - Center_x, Vertex_y - Center_y)*\frac{180}{\pi}+360 %https://de.wikipedia.org/wiki/Arctan2
\end{align}
Die Koordianten werden nach aufsteigendem Winkel sortiert. Somit sind die Koordinaten gegen den Uhrzeigersinn angeordnet. Final wird in der Applikation dynamisch
ein \ac{svg} Grafik mit den Strecken zwischen den Koordinaten über dem CIE 1931 Diagramm erzeugt.\\
%% // TODO: Bild
\subsection{Zeichnung eines kombinierten Gamut}
Hier bestand die Aufgabe zu bestimmten, ob Koordinaten (oder auch als Vertex bezeichnet) eines Gamut A innerhalb eines Gamut B einer anderen Lampe liegen. Wenn diese
Bedingung erfüllt ist, muss zur ermittung des gemeinsamen Gamut muss ermittelt werden, ob ein Punkt innerhalb des bestehenden Polygons liegt. Dies wurde mit dem
Sutherland–Hodgman Algorithmus \cite{sutherlandHodgman} bewerkstelligt. Für diesen Algorithmus werden die Vertex Daten des zu analysierenden Polygons benötigt. Die
Vertex Daten sind hier die CIE 1931 xy Koordinaten. Wichtig ist, dass die Vertices gegen den Uhrzeigersinn vorsortiert sind.\\
Der Algorithmus spannt die Gerade zwischen zwei Vertices auf und prüft auf welcher Seite der Geraden sich die bisherigen Gamut Vertices befinden. Wenn beide Vertices
sich auf der gegen den Uhrzeigersinn linken Seite, der Gamutflächenseite, befindet, wird der zweite Vertex der Gamutvertex Liste hinzugefügt.\\
Liegt der erste der beiden Vertices außerhalb der Flächenseite wird der, auf der Fläche liegende Vertex und der Schnittpunkt des Polygons und der Gamutflächenseite der
Gamutvertex Liste hinzugefügt (siehe Bild).
%% // TODO: Bild (beispiel Koordinaten system mit zwei geraden zur simulation)
Liegt der zweite Vertex außerhalb der Gamutflächenseite wird der Schnittpunkt des Polygons und der Gamutflächenseite der Gamutvertex Liste hinzugefügt. Diese Vorgehensweise
wird in der Applikation für jede selektierte Lampe wiederholt. Gestartet wird mit dem Gamut der ersten selektierten Lampe. Dieser Gamut wird mit dem der nächsten Lampe
zusammengeführt. Der daraus entstehende kombinierte Gamut wird nun mit dem der nächsten selektierten Lampe ebenfalls zusammengeführt, bis alle Lampen der Selektion durlaufen
sind. Der hier entstehnde Gamut wird nun in dem CIE 1931 Diagramm weiß eingezeichnet. Zusätzlich wird in schwarz der Gamut der einzelnen Lampen eingezeichnet (siehe Bild).
%% // TODO: Bild
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Ansteuerung externer Lichtquellen %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Ansteuerung externer Lichtquellen}
Zur automatisierung der Vermessung der Lichtquellen ist es nötig, dass die messende Applikation auch die Lichtquellen ansteuern kann. Somit wurde
in der Applikation eine \ac{dmx} Steuerung mit Art-Net implementiert. Weiter wurde ermöglicht, mehrere Lampen zu verwalten und zu steuern, um später mehrere
vermessene Lampen ansteuern zu können.
\subsection{Fixturetypen}
Lichtquellen verschiedener Hersteller haben viele unterschiedliche Funktionen. Von einer Helligkeitsregelung, dem Dimmer, über mehrere Emitter, wie
die hier venrwendeten Lichtquellen, bis zu Bewegungssteuerungen mehrerer Achsen, wie beim Robe LEDWash 300.\\
Die Zuordnung dieser Funktionen zu den DMX Steuerkanälen der Lampe ist somit je nach Funktionalitätsumfang von Lampe zu Lampe und auch bei einem gleichen
Lampentyp von Hersteller zu Hersteller unterschiedlich. So findet sich beispielsweise bei der Light Can kein Dimmer Steuerkanal für die Gesamtintensität
der Lampe. Hier werden nur Steuerkanäle der einzelnen Emitter bereitgestellt.
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{.49\textwidth}
        \includegraphics[width=\textwidth]{images/dmx_chart_light_can_4_channel_mode.png}
        \caption{Light Can 4 Channel Mode \cite{lightCanDMX}}
    \end{subfigure}
    \hfill 
    \begin{subfigure}[b]{.49\textwidth}
        \includegraphics[width=\textwidth]{images/dmx_chart_skypanel_mode_4.png}
        \caption{Auszug SkyPanel Mode 4 \cite{skypanelDMX}}
    \end{subfigure}
    \caption{DMX Charts der Hersteller Ape Labs und Arri}
\end{figure}
\noindent
Das SkyPanel hingegen bietet 31 sogenannte DMX Modi, die Light Can 3 Modi. Je nach Wahl des DMX Modus wechselt die Belegung der \ac{dmx} Steuerkanäle, auf die
die Lampe reagiert. Hier wird nach Anwendungsfall ein DMX Mode gewählt. Das SkyPanel bietet auch in einem DMX Modus eine Ansteuerung von CIE 1931 x und
y Kanälen auf zwei \ac{dmx} Kanälen. Dies wird ermöglicht durch in der Lampe internes Umsetzen der empfangenen \ac{dmx} Werte auf diesen Kanälen in Helligkeitswerte
für die einzelnen Emitter.\\
Eine abstrahierte, oder auch vereinheitliche Steuerung für äquivalente Lampenfunktionen ist durch diese Unterschiede in der Belegung nur durch
Zuordnungstabellen in der Software möglich. Hier wird die gewählte Belegung der Lampe hinterlegt, um mit einem Schieberegler für den roten Emitter
wie in Bild \ref{fig:emitterFaders} den entsprechenden Steuerkanal mit dem eingestellten Wert zu beschicken.\\
\\
Diese Zuordnungstabellen nennt man in der Brache (engl.) "'Fixturetypen"'.
\clearpage
\begin{wrapfigure}{r}{0.3\textwidth}
    \vspace{-25pt}
    \begin{center}
        \includegraphics[width=0.3\textwidth]{images/code_fixturetype_skypanel.png}
    \end{center}
    \vspace{-20pt}
    \caption{Fixturetyp Definition im Applikationscode} \label{fig:code_fixturetype}
    \vspace{-15pt}
\end{wrapfigure}
\noindent
In der Applikation ist dies eine statische \ac{json} Liste von Fixturetypen (Bild \ref{fig:code_fixturetype}). Hier wird lediglich festgehalten, welche
Emitter die Lampe hat und auf welchem \ac{dmx} Kanal des Modus sich der Emitter bezogen auf 1 befindet. Weiter ob die Lampe einen Dimmer Kanal hat und
wenn ja auf welchem Kanal dieser zu finden ist.
\subsection{Patch}
Im sogenannten "'Patch"' oder auch "'Adressierung"' legt man fest, welche Lampen man steuern möchte. Ein Patcheintrag besteht aus den Informationen
des verwendeten Fixturetypen und der DMX Startadresse. Die DMX Startadresse ist eine Nummer zwischen 1 und 512, welche man an der Lampe einstellt.
Alle weiteren Steuerkanäle des DMX Modus der Lampe folgen dann auf diese Startadresse. Hier muss bei mehreren Lampen auf einer DMX Linie darauf geachtet
werden, dass sich keine Lampen in ihren Steuerkanälen ungewollt überlappen.\\
Die gleiche Startadresse pro Lampe muss dann mit dem entsprechenden Fixturetypen und dem korrekten Modus der Steuerungssoftware eingegeben werden.\\
In der Applikation werden beim Hinzufügen von Lampen im Hintergrund noch weitere Dinge erledigt. Durch das Nutzen von mehreren Lampen musste die Art
und Weise umgestellt werden, wie Emitter und die angelegten Lampen selbst verwaltet werden.\\
Die Emitter Sektion wird nun automatisch erzeugt. Anhand der genutzten Fixturetypen wird zusammengetragen, welche Arten von Emittern benötigt werden.
Für alle verwendeten Emitter wird eine entsprechende Representation mit einem Schieberegler erzeugt. Die "'Add Emitter"' Schaltfläche zum manuellen
Hinzufügen von Emittern entfällt.\\
Falls für den Fixturetypen bereits eine vergangene Messung auf der Festplatte verfügbar ist, wird diese dem Fixture als Emitter Daten zugewiesen.
Wenn keine Daten vorhanden sind, wird das Fixture als nicht vermessen markiert.\\
Zuletzt wird der Patch gesichert und auch beim nächsten Öffnen der Applikation auch wieder geladen.
\subsection{Fixture Sheet}
Ein sogenanntes "'Fixture Sheet"' ist eine Auflistung der gepatchten Fixtures und deren aktueller Zustand.
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=.9\textwidth]{images/app_fixture_sheet_dummy.png}
    \end{center}
    \caption{Fixture Sheet in der Applikation mit Selektion}\label{fig:fixtureSheet}
\end{figure}
\noindent
Weiter wird hier eine Selektion eingeführt. Nur selektierte Fixtures werden über die Schieberegler in ihren Werten manipuliert. Alle anderen Werte bleiben
unangetastet. Alle selektierten Fixtures werden mit gelber Schrift gekennzeichnet.\\
Jede Reihe des Fixture Sheets außer der obersten repräsentiert den Zustand eines gepatchten Fixtures. In der ersten Spalte in Bild \ref{fig:fixtureSheet}
wird eine inkrementierte Nummer angezeigt, um mehrere Fixtures des gleichen Typs auseinanderhalten zu können. In der zweiten Spalte wird der Name des
Fixturetyps angezeigt, um diesen zu identifizieren.\\
Die folgenden Spalten bis "'M"' werden dynamisch je nach genutzten Attributen generiert. Nutzt ein Fixture ein Attribut nicht, wird die Spalte leer gelassen.
Wird das Attribut genutzt, wird der aktuelle Wert, der mit den Schiebereglern eingestellt wurde, von 0 bis 100 angezeigt. Dieser Wert soll später via \ac{dmx}
ausgegeben werden.\\
Die Spalte "'M"' steht für "'Measure"'. Mit dem Anklicken der Zelle wird später automatisiert das Vermessen des Fixtures angestoßen. Mit Klicken auf die
Zelle in der Spalte "'S"' für "'Settings"' also Einstellungen, können nun hier in einem Popup die gemessenen Emitter Werte eingesehen werden.
\subsection{Art-Net Implementierung}
Zur Ansteuerung der Lampen mit \ac{dmx} wurde eine einfache Art-Net Implementierung aus dem NPM Modul "'artnet"' von dem Alias "'hobbyquaker"' genutzt
\cite{artnetPackage}. Zur Art-Net - DMX Umsetzung wurde ein grandMA3 "'4Port Node"' genutzt. Dieser wurde als Protokoll Wandler eingesetzt.\\
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=.9\textwidth]{images/Data_transmission_scheme.png}
    \end{center}
    \caption{Schema der DMX Übertragung zu einer LightCan}\label{fig:dataScheme}
\end{figure}
\noindent
Im Fall der Lampen der Firma Ape Labs wird ein weiteres Gerät, bezeichnet als "'WAPP"' zur DMX - W-DMX Umsetzung genutzt.\\
In der Applikation wird mit jeder Einstellung an einem beliebigen Schieberegler das Zusammenstellen neuer DMX Informationen angestoßen. Jede gepatchte
Instanz eines Fixturetypen hält ihre aktuell eingestellten Werte. Diese Werte werden mit der DMX Startadresse der Instanz und der Belegung der Steuerkanäle
des Fixturetypen in das DMX Universum eingepflegt. Die in der Applikation geführten Werte von 0 bis 100 werden mit 2.55 multipliziert. Somit ergeben sich die
zu übertragenden DMX Werte.\\
Dieses gefüllte DMX Universum wird aus dem Webcode dem Appcode übergeben. In der Appcode Sektion wird das DMX Universum der artnet Bibliothek übergeben. Diese
wiederum nimmt diese Daten als akutellen Zustand für das Art-Net Universum 1. Dieser Zustand wird unmittelbar als ArtDmx Paket (siehe Tabelle \ref{tab:ArtDmxDefinition})
im Broadcast Modus an die IP "'2.255.255.255"' gesendet.\\
Solange der artnet Bibliothek kein neuer Universum Zustand übergeben wird, sendet diese alle 900 Millisekunden ein leeres ArtDmx Paket für diese Universum als
sogenanntes "'Keep-Alive"' Signal. Dies wird übertragen, um einerseits dem Art-Net Empfänger zu signalisieren, dass die Übertragung nicht abgebrochen ist,
andererseits ist das Paket leer um nicht informationslose Daten zu übertragen.\\
Der Art-Net Empfänger, welcher in dieser Arbeit ein 4port Node der Firma MA Lighting Technology ist empfängt diese ArtDmx Pakete, und gibt diese mit dem äquivalenten
DMX Universum konfigurierten DMX Ausgängen aus. Dieses DMX Signal wird dann kabelgebunden an die DMX Empfänger weitergeleitet.\\
DMX Empfänger sind in dieser Arbeit die Lampen, beziehungsweise im Fall der Ape Labs Produkte der "'WAPP"'.
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Automatisierung %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Automatisierung}
{\color{red}
Hier folgen Notizen:\\
Anpassung der Fader Werte anhand von Kalibrierungsdaten und Anpassen der auszugebenden DMX Werte\\
 - Vorgehensweise\\
 - Mathematik\\
 - Verwendeter Algorithmus\\
 - Analyse (stärken und Schwächen)
\begin{addmargin}[2em]{0em}
    - Light Can innere Algorithmen\\
    - Exemplarische Ergebnisse
\end{addmargin}}
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%% Anhang %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\thesubsection}{\Alph{subsection}}
\section*{Anhang}
\addcontentsline{toc}{section}{Anhang}

\subsection{Abbildungsverzeichnis}
\begingroup
\renewcommand{\section}[2]{}
\listoffigures
\endgroup
\clearpage

\subsection{Abkürzungsverzeichnis}
\begin{acronym}
    \acro{ascii}[ASCII]{American Standard Code for Information Interchange}
    \acro{cie}[CIE]{Commission internationale de l’éclairage}
    \acro{css}[CSS]{Cascading Style Sheets}
    \acro{dmx}[DMX]{Digital Multiplex}
    \acro{hmi}[HMI]{Hydrargyrum mediumarc iodite}
    \acro{html}[HTML]{Hypertext Markup Language}
    \acro{i2c}[I2C]{Inter-Integrated Circuit}
    \acro{ic}[IC]{Integrated Circuit}
    \acro{json}[JSON]{JavaScript Object Notation}
    \acro{led}[LED]{Light Emitting Diode}
    \acro{MBps}[MBps]{Megabits pro Sekunde}
    \acro{nir}[NIR]{Near Infrared}
    \acro{npm}[NPM]{Network Paket Manager for Javascript}
    \acro{par}[PAR]{Parabolic Aluminized Refelector}
    \acro{rdm}[RDM]{Remote Device Management}
    \acro{svg}[SVG]{Scalable Vector Graphics}
    \acro{thz}[THz]{Teraherz}
    \acro{uart}[UART]{Universal Asynchronous Receiver Transmitter}
    \acro{usb}[USB]{Universal Serial Bus}
    \acro{xlr}[XLR]{drei oder fünf polige Steckverbindung}
    \acro{xml}[XML]{Extensible Markup Language}
\end{acronym}
\clearpage

\subsection{Formelzeichen und Konstanten}
$\lambda$ - Lambda - Wellenlänge\\
\\
$\phi$ - Phi - Winkel\\
\\
c - Lichtgeschwindigkeit - 299 792 458 meter pro sekunde
\clearpage

\subsection{Literaturverzeichnis}
\begingroup
\renewcommand{\section}[2]{}
\begin{thebibliography}{xxxxxxxxxxxxxxxxxxx}
    \bibitem[Art-Net Homepage, 2019]{artnet}"'Home - Art-Net"', \url{https://art-net.org.uk/}. Visited on: 07.08.2019
    \bibitem[Art-Net Documatation, 2019]{artdmx}"'ArtDmx – Packet Definition - Art-Net"', \url{https://art-net.org.uk/structure/streaming-packets/artdmx-packet-definition/}. Visited on: 10.08.2019
    \bibitem[Electron Homepage, 2019]{electron}"'Electron | Plattformübergreifende Desktop-Anwendungen mit JavaScript, HTML und CSS entwickeln."', \url{https://electronjs.org/}. Visited on: 08.08.2019
    \bibitem[Licht Wikipedia, 2019]{wikiLicht}"'Licht - Wikipedia"', \url{https://de.wikipedia.org/wiki/Licht}. Visited on: 11.08.2019
    \bibitem[Farbtemperatur Wikipedia, 2019]{wikiFarbtemperatur}"'Farbtemperatur - Wikipedia"', \url{https://de.wikipedia.org/wiki/Farbtemperatur}. Visited on: 14.09.2019
    \bibitem[Wikipedia, 2019]{spectrumLight}"'Electromagnetic spectrum - Wikipedia"', \url{https://en.wikipedia.org/wiki/Electromagnetic_spectrum}. Visited on: 11.08.2019
    \bibitem[Lichtquellen, 2015]{lichtquellen} Dohlus, Rainer: "'Lichtquellen"' De Gruyter, Berlin, 2015, 
    \bibitem[Farbwahrnehmung FHT Esslingen, 2019]{fhtEsslignen}"'Farbwahrnehmung"', \url{http://www.it.fht-esslingen.de/~asbeck/gdial/farbe/sehen2.html}. Visited on: 11.08.2019
    \bibitem[Leuchtdiode Wikipedia, 2019]{wikiLed}"'Leuchtdiode - Wikipedia"', \url{https://de.wikipedia.org/wiki/Leuchtdiode}. Visited on: 21.08.2019
    \bibitem[Showlicht von Scribble zum fertigen Desgin, 2014]{showlicht}"'Showlicht von Scribble zum fertigen Desgin"', 01.09.2019
    \bibitem[Philips PAR64 Leuchtmittel 1000W | Thomann, 2019]{convpar}"'Philips PAR64 Leuchtmittel 1000W | Thomann"', \url{https://www.thomann.de/de/philips_par64_1000_watt_mfl_cp62_exe.htm}. Visited on: 02.09.2019
    \bibitem[P FLAT PRO 18 IP65 | Cameo, 2019]{ledpar}"'P FLAT PRO 18 IP65 | Cameo"', \url{https://www.cameolight.com/de/loesungen/installation/outdoor-lichttechnik/outdoor-scheinwerfer/2297/p-flat-pro-18-ip65?c=1826}. Visited on: 02.09.2019
    \bibitem[Ape Labs Homepage,2019]{lightCan} \url{https://apelabs.com/products/leuchtdose}. Visited on: 02.09.2019
    \bibitem[Robe Homepage,2019]{robe} \url{https://www.robe.cz/ledwash-300plus/}. Visited on: 02.09.2019
    \bibitem[Arri Homepage,2019]{arri} \url{https://www.arri.com/en/lighting/led/skypanel/s60-c}. Visited on: 02.09.2019
    \bibitem[UPRtek Homepage,2019]{uprtek} \url{https://www.uprtek.com/de/product/LED-Test-Measurement-Handspektrometer/MK350N-Basic-Handheld-Spectrometer.html}. Visited on: 09.09.2019
    \bibitem[Adafruit Learn, 2019]{adafruit}"'Overview | Adafruit AS7262 6-channel Visible Light Sensor | Adafruit Learning System"', \url{https://learn.adafruit.com/adafruit-as7262-6-channel-visible-light-sensor}. Visited on: 11.08.2019
    \bibitem[AS7261 Datenblatt, 2019]{datasheet61}"'AS7261 XYZ Chromatic White Color Sensor + NIR with Electronic Shutter and Smart Interface"', \url{https://ams.com/documents/20143/36005/AS7261_DS000493_1-00.pdf/0e7d1f12-702e-d061-b07a-67b0b6316800}. Visited on: 11.08.2019
    \bibitem[AS7262 Datenblatt, 2019]{datasheet62}"'AS7262 6-Channel Visible Spectral ID Device with Electronic Shutter and Smart Interface"', \url{https://ams.com/documents/20143/36005/AS7262_DS000486_2-00.pdf/0031f605-5629-e030-73b2-f365fd36a43b}. Visited on: 11.08.2019
    \bibitem[Lindbloom Homepage,2019]{lindbloom} \url{http://brucelindbloom.com/index.html}. Visited on: 09.09.2019
    \bibitem[Wisotop Homepage,2019]{wisotop} \url{https://wisotop.de/Anhang-Tristimulus-Werte.php}. Visited on: 09.09.2019
    \bibitem[Light Can Manual,2019]{lightCanDMX} \url{http://download.apelabs.com/manuals/Ape_Labs_-_LightCan_-_Manual_-_web.pdf} Page 33. Visited on: 16.09.2019
    \bibitem[SkyPanel Manual,2019]{skypanelDMX} \url{https://www.arri.com/resource/blob/65958/560471fec7f8f2e186ef8ca9e6cdd489/arri-skypanel-dmx-protocol-specification-v4-4-en-okt2018-data.pdf} Page 12. Visited on: 16.09.2019
    \bibitem[artnet NPMJS,2019]{artnetPackage} \url{https://www.npmjs.com/package/artnet}. Visited on: 16.09.2019
    \bibitem[Sutherland–Hodgman algorithm Wikipedia,2019]{sutherlandHodgman} \url{https://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman_algorithm}. Visited on: 22.09.2019
\end{thebibliography}
\endgroup
\clearpage

%\section{\LaTeX Beispiele}
%\begin{align}
%E &= mc^2\\
%m &= \frac{m_0}{\sqrt{1-\frac{v^2}{c^2}}}
%\end{align}
%\\
%Sonderzeichen
%\url{https://de.wikibooks.org/wiki/LaTeX-Kompendium:_Sonderzeichen}\\
%micro - $\mu$\\
%\\
%Lines
%\url{https://www.namsu.de/latex/kapitel6.html}\\
%\\
%Embed figures
%\url{https://en.wikibooks.org/wiki/LaTeX/Floats,_Figures_and_Captions}\\
%\\
%Sub and Top Text
%\textsuperscript{top} and \textsubscript{sub}\\
%\\
%Fußnoten
%\footnote{Text der Fußnote}
%\clearpage

\end{document}